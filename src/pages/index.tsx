import Head from "next/head";
import Image from "next/image";
import { Inter } from "@next/font/google";
import { blogData } from "@/data/blogData";
import { useState } from "react";

const inter = Inter({ subsets: ["latin"] });

interface BlogPost {
  id: number;
  slug: string;
  title: string;
  excerpt: string;
  imageUrl: string;
  categories: number[];
}

interface BlogCategory {
  id: number;
  name: string;
  slug: string;
}

interface BlogData {
  posts: BlogPost[];
  categories: BlogCategory[];
}

const LINKS = [
  {
    href: "https://emersoft.co/",
    name: "Home",
  },
  {
    href: "https://emersoft.co/about/",
    name: "Get to know us",
  },
  {
    href: "https://emersoft.co/our-work/",
    name: "Our work",
  },
  {
    href: "https://emersoft.co/services/hire-developers/",
    name: "Hire Developers",
  },
  {
    href: "https://emersoft.co/services/",
    name: "Services",
  },
  {
    href: "https://careers.emersoft.co/",
    name: "Careers",
  },
  // {
  //   href: "http://localhost:3000/",
  //   name: "Blog",
  // },
];

export default function Blog() {
  const [stableBlogData, setStableBlogData] = useState<BlogData>(blogData);
  const [blogPosts, setBlogPosts] = useState<BlogData>(blogData);
  const [activeCategory, setActiveCategory] = useState<string>("");

  const filteredPostsBasedOnCategoryId = (id: number) => {
    console.log("Chosen ID", id);
    console.log("Filtered table", {
      posts: stableBlogData.posts.filter((post) => post.categories[0] === id),
    });

    setBlogPosts((prevState) => ({
      ...prevState,
      posts: stableBlogData.posts.filter((post) => post.categories[0] === id),
      categories: prevState.categories,
    }));
  };

  return (
    <>
      <Head>
        <title>Patryk Kwasek | Emersoft - Blog</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main>
        <div className="max-w-screen-xl w-full my-0 mx-auto">
          <header className="flex justify-between items-center py-12">
            <div className="flex items-center">
              <Image
                src={"/apple-touch-icon.png"}
                width={150}
                height={150}
                alt="Creator Avatar"
                priority
                style={{ borderRadius: "100%", width: "48px", height: "48px" }}
                className="mr-4"
              />
              <span className="font-bold">Patryk Kwasek</span>
            </div>
            <ul className="flex row">
              {LINKS.map(({ href, name }) => (
                <li key={name}>
                  <a
                    href={href}
                    target="_blank"
                    rel="noopener noreferrer"
                    className="py-4 px-3 hover:text-emersoft-green"
                  >
                    {name}
                  </a>
                </li>
              ))}
              <li>
                <a
                  href="http://localhost:3000/"
                  className="text-white bg-emersoft-green font-bold py-4 px-3 hover:bg-emersoft-black duration-500"
                >
                  Blog
                </a>
              </li>
            </ul>
          </header>

          <div>
            <h3 className="text-emersoft-green text-3xl font-bold mb-4 uppercase">
              Hello, my name is Patryk
            </h3>
            <h1 className="text-7xl font-bold">Emersoft README.md</h1>

            <div>
              <input
                type="text"
                placeholder="Search in Readme..."
                className=""
              />
            </div>

            <div>
              {stableBlogData.categories.map(({ id, name, slug }) => (
                <button
                  key={slug}
                  className="border border-emersoft-green mb-3 mr-2 px-6 py-1.5 font-bold rounded-3xl hover:text-white hover:bg-emersoft-green duration-500"
                  onClick={() => filteredPostsBasedOnCategoryId(id)}
                >
                  {name}
                </button>
              ))}
            </div>

            <div>
              <h2 className="text-3xl font-medium">Featured Posts</h2>

              <div>
                <ul
                  style={{
                    display: "flex",
                    flexWrap: "wrap",
                    alignItems: "center",
                    justifyContent: "space-between",
                  }}
                >
                  {blogPosts.posts.map(
                    ({ id, title, excerpt, imageUrl, categories }) => (
                      <li
                        key={`Post-${id}`}
                        className="blog-post"
                        style={{
                          border: "1px solid gray",
                          maxWidth: "300px",
                          width: "100%",
                          minHeight: "500px",
                          height: "100%",
                          borderRadius: "25px",
                          margin: "20px 0",
                          cursor: "pointer",
                        }}
                      >
                        <Image
                          src={imageUrl}
                          width={800}
                          height={600}
                          alt={title}
                          priority
                          style={{
                            borderTopLeftRadius: "25px",
                            borderTopRightRadius: "25px",
                            width: "100%",
                            height: "100%",
                          }}
                        />

                        <div style={{ padding: "0 12px" }}>
                          <p>
                            {categories.map((category, index) => (
                              <span key={index}>
                                {stableBlogData.categories
                                  .filter(
                                    (stableCategory) =>
                                      stableCategory.id === category
                                  )
                                  .map((item) => item.name)}
                              </span>
                            ))}
                          </p>

                          <h2>{title}</h2>

                          <p>{excerpt}</p>
                        </div>
                      </li>
                    )
                  )}
                </ul>
              </div>
            </div>
          </div>
        </div>

        <footer className="border-t border-gray-300 py-8">
          <div className="flex max-w-screen-xl w-full my-0 mx-auto">
            <div className="mr-14">
              <strong>LinekdIn</strong>
              <p>
                <a
                  href="https://pl.linkedin.com/in/patryk-kwasek-0b9a821b3"
                  className="underline"
                >
                  Patryk Kwasek
                </a>
              </p>
            </div>

            <div>
              <strong>Github Icon</strong>
              <p>
                <a href="https://github.com/Web-Hulk" className="underline">
                  Github
                </a>
              </p>
            </div>
          </div>
        </footer>
      </main>
    </>
  );
}
